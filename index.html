<!DOCTYPE html>
<html>
  <head>
    <title>FLEXBLOK API Docs</title>
    <link rel="icon" type="image/png" href="favicon.png"/>
    <script src="https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js"></script>
    <style>
      body {
          margin: 0;
          font-family: Arial, sans-serif;
      }
      
      /* Top Header Styling */
      .top-header {
          background: #111827;
          padding: 15px;
          display: flex;
          align-items: center;
      }
      
      /* Logo Styling */
      .top-header img {
          height: 50px;
          margin-left: 15px;
      }
      
      /* White Background for Sidebar */
      .redoc-wrap .menu-content {
          background-color: white !important;
      }
      
      /* Ensure the main content height is correct */
      #redoc-container {
          height: calc(100vh - 80px);
      }

      /* Hide Base URL */
      .api-content h2 small {
          display: none !important;
      }
      .redoc-json-schema-view .json-schema-row:first-child {
          display: none !important;
      }

      /* Hide Base URL inside request boxes */
      .redoc-wrap .http-url {
          display: none !important;
      }
  </style>
</head>
<body>
  <div class="top-header">
      <img src="flexblok-logo.png" alt="FLEXBLOK Logo">
  </div>

  <div id="redoc-container"></div>

  <script>
    async function fetchAndModifySpec() {
        try {
            const response = await fetch("https://inf.flexblok.io/besu-api/swagger.json");
            let spec = await response.json();

            // Remove "/besu-api/" from server URL
            if (spec.servers && spec.servers.length > 0) {
                spec.servers[0].url = "/";
            }

            // Remove "/besu-api/" from all paths
            let newPaths = {};
            for (let path in spec.paths) {
                let newPath = path.replace(/^\/besu-api/, ""); 
                newPaths[newPath] = spec.paths[path];
            }
            spec.paths = newPaths;

            // Load Redoc with the modified spec
            Redoc.init(spec, { hideHostname: true }, document.getElementById("redoc-container"));

        } catch (error) {
            console.error("Error loading OpenAPI spec:", error);
        }
    }

    fetchAndModifySpec();
  </script>
</body>
</html>
